{"version":3,"file":"static/webpack/static\\development\\pages\\invitation.js.0756539fb14af4851a3e.hot-update.js","sources":["webpack:///./pages/invitation.js"],"sourcesContent":["import React from \"react\";\r\nimport Layout from '../components/MyLayout';\r\nimport Table from '../components/Table';\r\nimport TableStyle from '../components/TableStyle';\r\nimport Link from 'next/link';\r\nimport fetch from 'isomorphic-unfetch';\r\nimport Dropdown from 'react-bootstrap/Dropdown';\r\nimport {BootstrapTable, TableHeaderColumn} from 'react-bootstrap-table';\r\n\r\nclass Invitation extends React.Component {\r\n\r\n  constructor(props) {\r\n    super(props)\r\n  }\r\n\r\n  static async getInitialProps(ctx) {\r\n    const invitationId = ctx.query.invitationId\r\n    console.log(`invitation id: ${invitationId}`)\r\n    const myUrl = 'http://localhost:8080/invitations/' + invitationId\r\n    console.log(`url: ${myUrl}`)\r\n    const response = await fetch(myUrl)\r\n    const data = await response.json();\r\n\r\n    return {\r\n      invitation: data\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const invitation = this.props.invitation\r\n    const guests = []\r\n    if (invitation) {\r\n      for (var i = 0; i < invitation.guests.length; i++) {\r\n        let guestElem = invitation.guests[i]\r\n        guests.push({\r\n          invitationId: invitation.invitation_id,\r\n          guestId: guestElem.guest_id,\r\n          guest: guestElem.guest_name,\r\n          attending: guestElem.attending,\r\n          meal: guestElem.meal\r\n        })\r\n      }\r\n    }\r\n    if (!invitation) {\r\n      return (\r\n        <div>'loading...'</div>\r\n      );\r\n    } else {\r\n      console.log(`got invitation: ${invitation.guests[0].attending}`)\r\n    }\r\n\r\n    function updateInvitation(invitationUpdate) {\r\n      console.log(`received invitation update: ${JSON.stringify(invitationUpdate)}`)\r\n      const invitationUpdateResponse = fetch('http://localhost:8080/invitations', {\r\n        method: 'PUT',\r\n        headers: {\r\n          'Content-Type': 'application/json'\r\n        },\r\n        body: JSON.stringify(invitationUpdate)\r\n      })\r\n      .then(function(response) {\r\n        if (!response.ok) {\r\n          throw Error(response.statusText);\r\n        } else {\r\n          console.log(`success updating invitation`)\r\n        }\r\n        return response;\r\n      })\r\n      .catch((error) => {\r\n        console.error('Error:', error);\r\n      });\r\n    }\r\n\r\n    // is called even when there's no change to the cell. i don't know if there's a way to get hooks into the previous state of the row from here (to tell if there's a difference)\r\n    function onAfterSaveCell(row, cellName, cellValue) {\r\n      alert(`Save cell ${cellName} with value ${cellValue}`);\r\n\r\n      let rowStr = '';\r\n      for (const prop in row) {\r\n        rowStr += prop + ': ' + row[prop] + '\\n';\r\n      }\r\n\r\n      alert('The whole row :\\n' + rowStr);\r\n      const meal = row['meal']\r\n      const attending = row['attending']\r\n      const invitationId = row['invitationId']\r\n      const guestId = row['guestId']\r\n\r\n      // update will be on each cell, so we only need to worry about one guest being updated at a time (since each guest is a row in the table)\r\n      let invitationUpdate = {\r\n        invitation_id: invitationId,\r\n        rsvped: true,\r\n        guests: [\r\n          {\r\n            guest_id: guestId,\r\n            attending: attending,\r\n            meal: meal\r\n          }\r\n        ]\r\n      }\r\n      console.log(`invitation update: ${JSON.stringify(invitationUpdate)}`)\r\n      updateInvitation(invitationUpdate)\r\n    }\r\n\r\n    function onBeforeSaveCell(row, cellName, cellValue) {\r\n      // You can do any validation on here for editing value,\r\n      // return false for reject the editing\r\n      if (cellName == 'meal') {\r\n        if (cellValue != 'BURGER' && cellValue != 'CHICKEN') {\r\n          console.log(`trying to change to invalid meal: ${cellValue}`)\r\n          return false\r\n        }\r\n      } else if (cellName == 'attending') {\r\n        if (cellValue != 'true' && cellValue != 'false') {\r\n          console.log(`trying to change to invalid attending: ${cellValue}`)\r\n          return false\r\n        }\r\n      }\r\n      return true;\r\n    }\r\n\r\n    const cellEditProp = {\r\n      mode: 'click',\r\n      blurToSave: true,\r\n      beforeSaveCell: onBeforeSaveCell, // a hook for before saving cell\r\n      afterSaveCell: onAfterSaveCell  // a hook for after saving cell\r\n    };\r\n\r\n    const trStyle = (row, rowIndex) => {\r\n      return {\r\n        backgroundColor: '#e6d5d5'\r\n      };\r\n    }\r\n\r\n    return (\r\n      <Layout>\r\n        <h2>Click a field to edit.</h2>\r\n        <BootstrapTable data={ guests }  cellEdit={ cellEditProp }\r\n          tableStyle={ { border: 'black 1px solid' } }\r\n          containerStyle={ { border: 'black 1px solid' } }\r\n          headerStyle={ { border: 'black 1px solid' } }\r\n          bodyStyle={ { border: 'black 1px solid' } }\r\n          trStyle={ trStyle }>\r\n            <TableHeaderColumn dataField='guest' isKey={ true }>Guest</TableHeaderColumn>\r\n            <TableHeaderColumn dataField='attending'>Attending</TableHeaderColumn>\r\n            <TableHeaderColumn dataField='meal'>Meal</TableHeaderColumn>\r\n        </BootstrapTable>\r\n      </Layout>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Invitation;\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AAEA;AAAA;AACA;AADA;AAEA;AACA;;;AAcA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AALA;AAOA;AACA;AACA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AAGA;AALA;AAQA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AAHA;AAJA;AAWA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AALA;AACA;AAMA;AACA;AACA;AADA;AAGA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AALA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;;;AAtIA;;;;;;AACA;AACA;AACA;AACA;;AACA;AACA;;AADA;;AACA;AACA;;AADA;AAEA;AACA;AADA;AACA;;;;;;;;;;;AAfA;AACA;AA8IA;;;;A","sourceRoot":""}